# .zshrc - Modular zsh configuration

#######################################################################################################################
# Powerlevel10k instant prompt (must stay at top)
#######################################################################################################################

if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

#######################################################################################################################
# Profile detection
#######################################################################################################################

source ~/.config/profile.d/detect.sh

#######################################################################################################################
# Load conf.d modules (in numeric order)
#######################################################################################################################

for conf in ~/.config/zsh/conf.d/[0-9]*.zsh(N); do
  source "$conf"
done

#######################################################################################################################
# Profile-specific configuration
#######################################################################################################################

if [[ -f ~/.config/zsh/conf.d/${DOTFILES_PROFILE}.zsh ]]; then
  source ~/.config/zsh/conf.d/${DOTFILES_PROFILE}.zsh
fi

#######################################################################################################################
# Keybindings
#######################################################################################################################

bindkey -e
